# Руководство по вкладу в экосистему «Колибри ИИ»

Документ описывает базовые ожидания для всех задач в этом репозитории. Более конкретные каталоги могут содержать собственные файлы `AGENTS.md`; их требования имеют приоритет над правилами, сформулированными здесь.

## Ключевые принципы
- Следуем изобретательской концепции «Колибри ИИ», разработанной главным архитектором Кочуровым Владиславом Евгеньевичем: лёгкость, точность и энергоэффективность решений.
- Проектируем компоненты модульно, обеспечивая переиспользование и доверенную интеграцию между сервисами.
- Отдаём приоритет сопровождаемости и ясности над микрооптимизациями, если явные требования к производительности не указаны.
- Каждое изменение должно отражать одну логическую задачу, чтобы команда могла быстро ревьюить и интегрировать результат.
- Любые архитектурные нововведения необходимо согласовывать с визионерской дорожной картой «Колибри ИИ».

## Стандарты кодирования
- **Python**: придерживаемся PEP 8, используем аннотации типов и пишем функции, решающие одну задачу. Отдельно проверяем пути обработки ошибок.
- **TypeScript/JavaScript**: соблюдаем настроенные линтеры (Prettier/ESLint), используем строгую типизацию и проектируем компоненты с явным управлением побочными эффектами.
- **Rust/C/C++**: сохраняем стиль целевого модуля, документируем `unsafe`-блоки и сложную логику.
- **Конфигурация и инфраструктура**: поясняем нестандартные значения и избегаем дублирования, если можно расширить существующие файлы.
- Соблюдаем требования к энергоэффективности: оптимизируем тяжелые вычисления, минимизируем холостые циклы и документируем затраты ресурсов.

## Документация
- Обновляем README или модульные описания при добавлении нового поведения, команд или конфигураций.
- Для новых публичных API или CLI приводим примеры использования с точки зрения команд «Колибри ИИ».
- Важные архитектурные решения фиксируем в `docs/` или добавляем новую заметку, если подходящего документа нет.
- Обязательно описываем метрики качества, которые изменение помогает достичь (SLO, NPS, энергоэффективность и т. д.).

## Тестирование
- На каждый багфикс или фичу добавляем/обновляем автоматические тесты.
- Перед публикацией убеждаемся, что локально проходят все связанные тесты.
- При исправлении пользовательских багов документируем шаги воспроизведения или добавляем падающий тест.
- По возможности включаем фаззинг, property-based тесты и статический анализ для критичных компонентов.

## Процессы ревью и инструменты
- Коммит-месседжи должны пояснять мотивацию изменений и их связь с концепцией «Колибри ИИ».
- Запускаем доступные линтеры, статические анализаторы и форматтеры до отправки изменений.
- Для фронтенд-улучшений прикладываем скриншоты/записи, демонстрирующие пользовательский сценарий.
- Фиксируем результаты ручной проверки энергоэффективности или измерений производительности, если они проводились.

## Работа с артефактами и данными
- Не коммитим чувствительные данные или большие бинарные файлы без явного одобрения.
- Повторно используемые наборы данных размещаем в `data/`, документируем происхождение и лицензию.
- Для обучающих моделей указываем требования к воспроизводимости и ссылки на пайплайны.

```kolibri-policy
build: ours
code: ours
docs: ours

files:
  prefer_ours:
    - backend/**
    - frontend/**
    - scripts/**
  prefer_theirs:
    - docs/**
    - README.md

budgets:
  wasm_max_kb: 61440
  step_latency_ms: 250
  coverage_min_lines: 75
  coverage_min_branches: 60
```

## Kolibri Swarm-1000 Orchestrator

Репозиторий включает систему **Kolibri Swarm-1000 Orchestrator** — оркестратор для управления 1000 логическими агентами, выполняющими задачи параллельно.

### Архитектура Swarm-1000

- **Worktree per worker**: каждый воркер работает в изолированном git worktree
- **Логическая модель**: 1000 агентов распределены по ролям (Backend, Frontend, Rust, DevOps, QA, Security, Design)
- **Физическое выполнение**: ограничено пулом воркеров (по умолчанию 20 параллельных)
- **Безопасность**: никаких удалений/перемещений вне репозитория; DRY RUN для опасных операций

### Команды сборки и тестирования

Для основного репозитория:
```bash
# Сборка (если применимо)
make build

# Тесты
pytest tests/

# Линтинг Python
ruff check .
```

Для Swarm-1000:
```bash
# Запуск оркестратора
python -m swarm1000.swarm --help

# Полный workflow
python -m swarm1000.swarm inventory --roots /path/to/projects
python -m swarm1000.swarm plan --goal "Цель" --budget-agents 1000
python -m swarm1000.swarm run --concurrency 20 --mode worktree --quality-gate strict

# Статус и отчеты
python -m swarm1000.swarm status
python -m swarm1000.swarm export --output results.json
```

### Протокол отчета для агентов

Агенты Swarm-1000 следуют протоколу:

1. **PLAN** → Получить задачу с зависимостями и DoD
2. **CHANGES** → Применить изменения через Codex MCP в worktree
3. **COMMANDS RUN** → Выполнить quality gate (lint/test/build)
4. **NEXT** → Закоммитить и перейти к следующей задаче

### Безопасность и ограничения

- ✓ Все изменения только внутри репозитория/worktrees
- ✓ Никаких деструктивных операций вне workspace
- ✓ DRY RUN для массовых переименований/удалений
- ✓ Секреты не логируются и не коммитятся
- ✓ Quality gate предотвращает некорректный код

См. документацию в `docs/SWARM1000.md`, `docs/GOVERNANCE.md`, `docs/SAFETY.md` для деталей.
